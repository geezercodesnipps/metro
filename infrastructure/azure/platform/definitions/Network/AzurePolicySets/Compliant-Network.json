{
  "type": "Microsoft.Authorization/policySetDefinitions",
  "apiVersion": "2021-06-01",
  "name": "Compliant-Network",
  "properties": {
    "metadata": {
      "version": "1.0.0",
      "category": "Network"
    },
    "policyType": "Custom",
    "displayName": "Enforce secure-by-default Network and Networking services for regulated industries",
    "description": "This policy initiative is a group of policies that ensures Network and Networking services are compliant per regulated Landing Zones",
    "policyDefinitionGroups": [
      {
        "name": "Encryption",
        "category": "Data Protection",
        "displayName": "Ensure Network is using secure encryption",
        "description": "Policy to ensure Network is using secure protocols"
      },
      {
        "name": "Network",
        "category": "Network Security",
        "displayName": "Ensure Network is securely configured and accessed",
        "description": "Policy to ensure Network is not accessible over the public internet"
      },
      {
        "name": "Logging",
        "category": "Logging and Threat Detection",
        "displayName": "Ensure Networking services are logging all events to Log Analytics",
        "description": "Policy to ensure Networking services are logging all events to Log Analytics workspace"
      },
      {
        "name": "Cost",
        "category": "Cost Optimization",
        "displayName": "Ensure Compute cost optimized",
        "description": "Policy to ensure Compute is cost optimized"
      }
    ],
    "parameters": {
      "subnetUdr": {
        "type": "string",
        "defaultValue": "Deny"
      },
      "subnetNsg": {
        "type": "string",
        "defaultValue": "Deny"
      },
      "denyInboundInternet": {
        "type": "string",
        "defaultValue": "Deny"
      },
      "appGwWaf": {
        "type": "string",
        "defaultValue": "Deny"
      },
      "vnetModifyDdos": {
        "type": "string",
        "defaultValue": "Modify"
      },
      "ddosPlanResourceId": {
        "type": "string",
        "defaultValue": ""
      },
      "nsgDiagnostics": {
        "type": "string",
        "defaultValue": "DeployIfNotExists"
      },
      "nsgLogAnalyticsWorkspaceId": {
        "type": "string",
        "defaultValue": ""
      },
      "wafMode": {
        "type": "string",
        "defaultValue": "Deny"
      },
      "wafModeRequirement": {
        "type": "string",
        "defaultValue": "Prevention"
      },
      "wafFwRules": {
        "type": "string",
        "defaultValue": "Deny"
      },
      "wafModeAppGw": {
        "type": "string",
        "defaultValue": "Deny"
      },
      "wafModeAppGwRequirement": {
        "type": "string",
        "defaultValue": "Prevention"
      },
      "lbDiagnostics": {
        "type": "string",
        "defaultValue": "DeployIfNotExists"
      },
      "lbDiagnosticsLogAnalyticsWorkspaceId": {
        "type": "string",
        "defaultValue": ""
      },
      "fdDiagnostics": {
        "type": "string",
        "defaultValue": "DeployIfNotExists"
      },
      "fdDiagnosticsLogAnalyticsWorkspaceId": {
        "type": "string",
        "defaultValue": ""
      },
      "tmDiagnostics": {
        "type": "string",
        "defaultValue": "DeployIfNotExists"
      },
      "tmDiagnosticsLogAnalyticsWorkspaceId": {
        "type": "string",
        "defaultValue": ""
      },
      "vnetDiagnostics": {
        "type": "string",
        "defaultValue": "DeployIfNotExists"
      },
      "vnetDiagnosticsLogAnalyticsWorkspaceId": {
        "type": "string",
        "defaultValue": ""
      },
      "denyRdpFromInternet": {
        "type": "string",
        "defaultValue": "Deny"
      },
      "denySshFromInternet": {
        "type": "string",
        "defaultValue": "Deny"
      },
      "erDiagnostics": {
        "type": "string",
        "defaultValue": "DeployIfNotExists"
      },
      "erDiagnosticsLogAnalyticsWorkspaceId": {
        "type": "string",
        "defaultValue": ""
      },
      "bastionDiagnostics": {
        "type": "string",
        "defaultValue": "DeployIfNotExists"
      },
      "bastionLogAnalyticsWorkspaceId": {
        "type": "string",
        "defaultValue": ""
      },
      "bastionLogCategories": {
        "type": "string",
        "defaultValue": "allLogs"
      },
      "fdCdnDiagnostics": {
        "type": "string",
        "defaultValue": "DeployIfNotExists"
      },
      "fdCdnLogAnalyticsWorkpaceId": {
        "type": "string",
        "defaultValue": ""
      },
      "fdCdnLogCategories": {
        "type": "string",
        "defaultValue": "allLogs"
      },
      "pipDiagnostics": {
        "type": "string",
        "defaultValue": "DeployIfNotExists"
      },
      "pipLogAnalyticsWorkspaceId": {
        "type": "string",
        "defaultValue": ""
      },
      "pipLogCategories": {
        "type": "string",
        "defaultValue": "allLogs"
      },
      "gwDiagnostics": {
        "type": "string",
        "defaultValue": "DeployIfNotExists"
      },
      "gwLogAnalyticsWorkspaceId": {
        "type": "string",
        "defaultValue": ""
      },
      "gwLogCategories": {
        "type": "string",
        "defaultValue": "allLogs"
      },
      "p2sDiagnostics": {
        "type": "string",
        "defaultValue": "DeployIfNotExists"
      },
      "p2sLogAnalyticsWorkspaceId": {
        "type": "string",
        "defaultValue": ""
      },
      "p2sLogCategories": {
        "type": "string",
        "defaultValue": "allLogs"
      },
      "afwEnableTlsForAllAppRules": {
        "type": "string",
        "defaultValue": "Deny"
      },
      "afwEnableTlsInspection": {
        "type": "string",
        "defaultValue": "Deny"
      },
      "afwEmptyIDPSBypassList": {
        "type": "string",
        "defaultValue": "Deny"
      },
      "afwEnableAllIDPSSignatureRules": {
        "type": "string",
        "defaultValue": "Deny"
      },
      "afwEnableIDPS": {
        "type": "string",
        "defaultValue": "Deny"
      },
      "wafAfdEnabled": {
        "type": "string",
        "defaultValue": "Deny"
      },
      "vpnAzureAD": {
        "type": "string",
        "defaultValue": "Deny"
      },
      "appGwDiagnostics": {
        "type": "string",
        "defaultValue": "DeployIfNotExists"
      },
      "appGwLogAnalyticsWorkspaceId": {
        "type": "string",
        "defaultValue": ""
      },
      "appGwTlsVersion": {
        "type": "string",
        "defaultValue": "Deny"
      },
      "modifyUdr": {
        "type": "string",
        "defaultValue": "Disabled"
      },
      "modifyUdrNextHopIpAddress": {
        "type": "string",
        "defaultValue": ""
      },
      "modifyUdrNextHopType": {
        "type": "string",
        "defaultValue": "None"
      },
      "modifyUdrAddressPrefix": {
        "type": "string",
        "defaultValue": "0.0.0.0/0"
      },
      "modifyNsg": {
        "type": "string",
        "defaultValue": "Disabled"
      },
      "modifyNsgRuleName": {
        "type": "string",
        "defaultValue": "DenyAnyInternetOutbound"
      },
      "modifyNsgRulePriority": {
        "type": "integer",
        "defaultValue": 1000
      },
      "modifyNsgRuleDirection": {
        "type": "string",
        "defaultValue": "Outbound"
      },
      "modifyNsgRuleAccess": {
        "type": "string",
        "defaultValue": "Deny"
      },
      "modifyNsgRuleProtocol": {
        "type": "string",
        "defaultValue": "*"
      },
      "modifyNsgRuleSourceAddressPrefix": {
        "type": "string",
        "defaultValue": "*"
      },
      "modifyNsgRuleSourcePortRange": {
        "type": "string",
        "defaultValue": "*"
      },
      "modifyNsgRuleDestinationAddressPrefix": {
        "type": "string",
        "defaultValue": "Internet"
      },
      "modifyNsgRuleDestinationPortRange": {
        "type": "string",
        "defaultValue": "*"
      },
      "modifyNsgRuleDescription": {
        "type": "string",
        "defaultValue": "Deny any outbound traffic to the Internet"
      },
      "fwDiagnostics": {
        "type": "string",
        "defaultValue": "DeployIfNotExists"
      },
      "fwLogAnalyticsWorkspaceId": {
        "type": "string",
        "defaultValue": ""
      },
      "denyActionVnetPlatform": {
        "type": "string",
        "defaultValue": "denyAction"
      },
      "spokeVnetPrefix": {
        "type": "string",
        "defaultValue": ""
      },
      "denyActionVnetPeeringAvnm": {
        "type": "string",
        "defaultValue": "denyAction"
      },
      "vnetPeeringPrefix": {
        "type": "string",
        "defaultValue": "AVNM_"
      },
      "publicIpAddressesUnusedResourcesCostOptimization": {
        "type": "string",
        "defaultValue": "Audit"
      },
      "firewallWithoutPolicy": {
        "type": "string",
        "defaultValue": "Deny"
      },
      "subnetServiceEndpoints": {
        "type": "string",
        "defaultValue": "Deny"
      },
      "subnetWithoutPrivateEndpointNetworkPolicies": {
        "type": "string",
        "defaultValue": "Deny"
      }
    },
    "policyDefinitions": [
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/35f9c03a-cc27-418e-9c0c-539ff999d010",
        "policyDefinitionReferenceId": "Deny-Nsg-GW-subnet",
        "groupNames": [
          "Network"
        ],
        "parameters": {}
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/21a6bc25-125e-4d13-b82d-2e19b7208ab7",
        "policyDefinitionReferenceId": "Deny-VPN-AzureAD",
        "groupNames": [
          "Network"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('vpnAzureAD')]"
          }
        }
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/055aa869-bc98-4af8-bafc-23f1ab6ffe2c",
        "policyDefinitionReferenceId": "Deny-Waf-Afd-Enabled",
        "groupNames": [
          "Network"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('wafAfdEnabled')]"
          }
        }
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6484db87-a62d-4327-9f07-80a2cbdf333a",
        "policyDefinitionReferenceId": "Deny-Waf-IDPS",
        "groupNames": [
          "Network"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('afwEnableIDPS')]"
          }
        }
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/610b6183-5f00-4d68-86d2-4ab4cb3a67a5",
        "policyDefinitionReferenceId": "Deny-FW-AllIDPSS",
        "groupNames": [
          "Network"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('afwEnableAllIDPSSignatureRules')]"
          }
        }
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f516dc7a-4543-4d40-aad6-98f76a706b50",
        "policyDefinitionReferenceId": "Deny-FW-EmpIDPSBypass",
        "groupNames": [
          "Network"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('afwEmptyIDPSBypassList')]"
          }
        }
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/711c24bb-7f18-4578-b192-81a6161e1f17",
        "policyDefinitionReferenceId": "Deny-FW-TLS-Inspection",
        "groupNames": [
          "Network"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('afwEnableTlsInspection')]"
          }
        }
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a58ac66d-92cb-409c-94b8-8e48d7a96596",
        "policyDefinitionReferenceId": "Deny-FW-TLS-AllApp",
        "groupNames": [
          "Network"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('afwEnableTlsForAllAppRules')]"
          }
        }
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cac9e1c5-c3cb-47fa-8d4c-88b8559262d2",
        "policyDefinitionReferenceId": "Dine-Diagnostics-P2S",
        "groupNames": [
          "Logging"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('p2sDiagnostics')]"
          },
          "categoryGroup": {
            "value": "[parameters('p2sLogCategories')]"
          },
          "logAnalytics": {
            "value": "[parameters('p2sLogAnalyticsWorkspaceId')]"
          }
        }
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ed6ae75a-828f-4fea-88fd-dead1145f1dd",
        "policyDefinitionReferenceId": "Dine-Diagnostics-Gw",
        "groupNames": [
          "Logging"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('gwDiagnostics')]"
          },
          "categoryGroup": {
            "value": "[parameters('gwLogCategories')]"
          },
          "logAnalytics": {
            "value": "[parameters('gwLogAnalyticsWorkspaceId')]"
          }
        }
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1513498c-3091-461a-b321-e9b433218d28",
        "policyDefinitionReferenceId": "Dine-Diagnostics-Pip",
        "groupNames": [
          "Logging"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('pipDiagnostics')]"
          },
          "categoryGroup": {
            "value": "[parameters('pipLogCategories')]"
          },
          "logAnalytics": {
            "value": "[parameters('pipLogAnalyticsWorkspaceId')]"
          }
        }
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6201aeb7-2b5c-4671-8ab4-5d3ba4d77f3b",
        "policyDefinitionReferenceId": "Dine-Diagnostics-FdCdn",
        "groupNames": [
          "Logging"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('fdCdnDiagnostics')]"
          },
          "categoryGroup": {
            "value": "[parameters('fdCdnLogCategories')]"
          },
          "logAnalytics": {
            "value": "[parameters('fdCdnLogAnalyticsWorkpaceId')]"
          }
        }
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f8352124-56fa-4f94-9441-425109cdc14b",
        "policyDefinitionReferenceId": "Dine-Diagnostics-Bastion",
        "groupNames": [
          "Logging"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('bastionDiagnostics')]"
          },
          "categoryGroup": {
            "value": "[parameters('bastionLogCategories')]"
          },
          "logAnalytics": {
            "value": "[parameters('bastionLogAnalyticsWorkspaceId')]"
          }
        }
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/12430be1-6cc8-4527-a9a8-e3d38f250096",
        "policyDefinitionReferenceId": "Deny-Waf-AppGw-mode",
        "groupNames": [
          "Network"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('wafModeAppGw')]"
          },
          "modeRequirement": {
            "value": "[parameters('wafModeAppGwRequirement')]"
          }
        }
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/632d3993-e2c0-44ea-a7db-2eca131f356d",
        "policyDefinitionReferenceId": "Deny-Waf-Fw-rules",
        "groupNames": [
          "Network"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('wafFwRules')]"
          }
        }
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/425bea59-a659-4cbb-8d31-34499bd030b8",
        "policyDefinitionReferenceId": "Deny-Waf-mode",
        "groupNames": [
          "Network"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('wafMode')]"
          },
          "modeRequirement": {
            "value": "[parameters('wafModeRequirement')]"
          }
        }
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/98a2e215-5382-489e-bd29-32e7190a39ba",
        "policyDefinitionReferenceId": "Dine-Nsg-Diagnostics",
        "groupNames": [
          "Logging"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('nsgDiagnostics')]"
          },
          "logAnalytics": {
            "value": "[parameters('nsgLogAnalyticsWorkspaceId')]"
          }
        }
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/94de2ad3-e0c1-4caf-ad78-5d47bbc83d3d",
        "policyDefinitionReferenceId": "Modify-vNet-DDoS",
        "groupNames": [
          "Encryption",
          "Network"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('vnetModifyDdos')]"
          },
          "ddosPlan": {
            "value": "[parameters('ddosPlanResourceId')]"
          }
        }
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/88c0b9da-ce96-4b03-9635-f29a937e2900",
        "policyDefinitionReferenceId": "Deny-Ip-Forwarding",
        "groupNames": [
          "Encryption",
          "Network"
        ],
        "parameters": {}
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/83a86a26-fd1f-447c-b59d-e51f44264114",
        "policyDefinitionReferenceId": "Deny-vNic-Pip",
        "groupNames": [
          "Encryption",
          "Network"
        ],
        "parameters": {}
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/564feb30-bf6a-4854-b4bb-0d2d2d1e6c66",
        "policyDefinitionReferenceId": "Deny-AppGw-Without-Waf",
        "groupNames": [
          "Encryption",
          "Network"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('appGwWaf')]"
          }
        }
      },
      {
        "policyDefinitionId": "${scope_id_root}/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-UDR",
        "policyDefinitionReferenceId": "Deny-Subnet-Without-UDR",
        "groupNames": [
          "Encryption",
          "Network"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('subnetUdr')]"
          }
        }
      },
      {
        "policyDefinitionId": "${scope_id_root}/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-NSG",
        "policyDefinitionReferenceId": "Deny-Subnet-Without-NSG",
        "groupNames": [
          "Encryption",
          "Network"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('subnetNsg')]"
          }
        }
      },
      {
        "policyDefinitionId": "${scope_id_root}/providers/Microsoft.Authorization/policyDefinitions/Deny-Inbound-Internet-All",
        "policyDefinitionReferenceId": "Deny-Inbound-Internet-All",
        "groupNames": [
          "Encryption",
          "Network"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('denyInboundInternet')]"
          }
        }
      },
      {
        "policyDefinitionId": "${scope_id_root}/providers/Microsoft.Authorization/policyDefinitions/Dine-Diagnostics-LoadBalancer",
        "policyDefinitionReferenceId": "Dine-Diagnostics-LoadBalancer",
        "groupNames": [
          "Logging"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('lbDiagnostics')]"
          },
          "logAnalytics": {
            "value": "[parameters('lbDiagnosticsLogAnalyticsWorkspaceId')]"
          }
        }
      },
      {
        "policyDefinitionId": "${scope_id_root}/providers/Microsoft.Authorization/policyDefinitions/Dine-Diagnostics-FrontDoor",
        "policyDefinitionReferenceId": "Dine-Diagnostics-FrontDoor",
        "groupNames": [
          "Logging"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('fdDiagnostics')]"
          },
          "logAnalytics": {
            "value": "[parameters('fdDiagnosticsLogAnalyticsWorkspaceId')]"
          }
        }
      },
      {
        "policyDefinitionId": "${scope_id_root}/providers/Microsoft.Authorization/policyDefinitions/Dine-Diagnostics-TrafficManager",
        "policyDefinitionReferenceId": "Dine-Diagnostics-TrafficManager",
        "groupNames": [
          "Logging"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('tmDiagnostics')]"
          },
          "logAnalytics": {
            "value": "[parameters('tmDiagnosticsLogAnalyticsWorkspaceId')]"
          }
        }
      },
      {
        "policyDefinitionId": "${scope_id_root}/providers/Microsoft.Authorization/policyDefinitions/Dine-Diagnostics-Vnet",
        "policyDefinitionReferenceId": "Dine-Diagnostics-Vnet",
        "groupNames": [
          "Logging"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('vnetDiagnostics')]"
          },
          "logAnalytics": {
            "value": "[parameters('vnetDiagnosticsLogAnalyticsWorkspaceId')]"
          }
        }
      },
      {
        "policyDefinitionId": "${scope_id_root}/providers/Microsoft.Authorization/policyDefinitions/Deny-Rdp-From-Internet",
        "policyDefinitionReferenceId": "Deny-Rdp-From-Internet",
        "groupNames": [
          "Network"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('denyRdpFromInternet')]"
          }
        }
      },
      {
        "policyDefinitionId": "${scope_id_root}/providers/Microsoft.Authorization/policyDefinitions/Deny-Ssh-From-Internet",
        "policyDefinitionReferenceId": "Deny-Ssh-From-Internet",
        "groupNames": [
          "Network"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('denySshFromInternet')]"
          }
        }
      },
      {
        "policyDefinitionId": "${scope_id_root}/providers/Microsoft.Authorization/policyDefinitions/Dine-Diagnostics-ExpressRouteCircuit",
        "policyDefinitionReferenceId": "Dine-Diagnostics-ExpressRouteCircuit",
        "groupNames": [
          "Logging"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('erDiagnostics')]"
          },
          "logAnalytics": {
            "value": "[parameters('erDiagnosticsLogAnalyticsWorkspaceId')]"
          }
        }
      },
      {
        "policyDefinitionId": "${scope_id_root}/providers/Microsoft.Authorization/policyDefinitions/Dine-Diagnostics-ApplicationGateway",
        "policyDefinitionReferenceId": "Dine-Diagnostics-ApplicationGateway",
        "groupNames": [
          "Logging"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('appGwDiagnostics')]"
          },
          "logAnalytics": {
            "value": "[parameters('appGwLogAnalyticsWorkspaceId')]"
          }
        }
      },
      {
        "policyDefinitionId": "${scope_id_root}/providers/Microsoft.Authorization/policyDefinitions/Deny-AppGw-Without-Tls",
        "policyDefinitionReferenceId": "Deny-AppGw-Without-Tls",
        "groupNames": [
          "Encryption",
          "Network"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('appGwTlsVersion')]"
          }
        }
      },
      {
        "policyDefinitionId": "${scope_id_root}/providers/Microsoft.Authorization/policyDefinitions/Modify-Udr",
        "policyDefinitionReferenceId": "Modify-Udr",
        "groupNames": [
          "Network"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('modifyUdr')]"
          },
          "nextHopIpAddress": {
            "value": "[parameters('modifyUdrNextHopIpAddress')]"
          },
          "nextHopType": {
            "value": "[parameters('modifyUdrNextHopType')]"
          },
          "addressPrefix": {
            "value": "[parameters('modifyUdrAddressPrefix')]"
          }
        }
      },
      {
        "policyDefinitionId": "${scope_id_root}/providers/Microsoft.Authorization/policyDefinitions/Modify-Nsg",
        "policyDefinitionReferenceId": "Modify-Nsg",
        "groupNames": [
          "Network"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('modifyNsg')]"
          },
          "nsgRuleName": {
            "value": "[parameters('modifyNsgRuleName')]"
          },
          "nsgRulePriority": {
            "value": "[parameters('modifyNsgRulePriority')]"
          },
          "nsgRuleDirection": {
            "value": "[parameters('modifyNsgRuleDirection')]"
          },
          "nsgRuleAccess": {
            "value": "[parameters('modifyNsgRuleAccess')]"
          },
          "nsgRuleProtocol": {
            "value": "[parameters('modifyNsgRuleProtocol')]"
          },
          "nsgRuleSourceAddressPrefix": {
            "value": "[parameters('modifyNsgRuleSourceAddressPrefix')]"
          },
          "nsgRuleSourcePortRange": {
            "value": "[parameters('modifyNsgRuleSourcePortRange')]"
          },
          "nsgRuleDestinationAddressPrefix": {
            "value": "[parameters('modifyNsgRuleDestinationAddressPrefix')]"
          },
          "nsgRuleDestinationPortRange": {
            "value": "[parameters('modifyNsgRuleDestinationPortRange')]"
          },
          "nsgRuleDescription": {
            "value": "[parameters('modifyNsgRuleDescription')]"
          }
        }
      },
      {
        "policyDefinitionId": "${scope_id_root}/providers/Microsoft.Authorization/policyDefinitions/Dine-Diagnostics-Firewall",
        "policyDefinitionReferenceId": "Dine-Diagnostics-Firewall",
        "groupNames": [
          "Logging"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('fwDiagnostics')]"
          },
          "logAnalytics": {
            "value": "[parameters('fwLogAnalyticsWorkspaceId')]"
          }
        }
      },
      {
        "policyDefinitionId": "${scope_id_root}/providers/Microsoft.Authorization/policyDefinitions/DenyAction-Vnet-Platform",
        "policyDefinitionReferenceId": "DenyAction-Vnet-Platform",
        "groupNames": [
          "Network"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('denyActionVnetPlatform')]"
          },
          "spokeVnetPrefix": {
            "value": "[parameters('spokeVnetPrefix')]"
          }
        }
      },
      {
        "policyDefinitionId": "${scope_id_root}/providers/Microsoft.Authorization/policyDefinitions/DenyAction-VnetPeerings-AVNM",
        "policyDefinitionReferenceId": "DenyAction-VnetPeerings-AVNM",
        "groupNames": [
          "Network"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('denyActionVnetPeeringAvnm')]"
          },
          "vnetPeeringPrefix": {
            "value": "[parameters('vnetPeeringPrefix')]"
          }
        }
      },
      {
        "policyDefinitionId": "${scope_id_root}/providers/Microsoft.Authorization/policyDefinitions/Audit-PublicIpAddresses-UnusedResourcesCostOptimization",
        "policyDefinitionReferenceId": "Audit-PublicIpAddresses-UnusedResourcesCostOptimization",
        "groupNames": [
          "Cost"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('publicIpAddressesUnusedResourcesCostOptimization')]"
          }
        }
      },
      {
        "policyDefinitionId": "${scope_id_root}/providers/Microsoft.Authorization/policyDefinitions/Deny-Firewall-WithoutPolicy",
        "policyDefinitionReferenceId": "Deny-Firewall-WithoutPolicy",
        "groupNames": [
          "Cost"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('firewallWithoutPolicy')]"
          }
        }
      },
      {
        "policyDefinitionId": "${scope_id_root}/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-ServiceEndpoints",
        "policyDefinitionReferenceId": "Deny-Subnet-ServiceEndpoints",
        "groupNames": [
          "Cost"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('subnetServiceEndpoints')]"
          }
        }
      },
      {
        "policyDefinitionId": "${scope_id_root}/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-PrivateEndpointNetworkPolicies",
        "policyDefinitionReferenceId": "Deny-Subnet-Without-PrivateEndpointNetworkPolicies",
        "groupNames": [
          "Cost"
        ],
        "parameters": {
          "effect": {
            "value": "[parameters('subnetWithoutPrivateEndpointNetworkPolicies')]"
          }
        }
      }
    ]
  }
}
